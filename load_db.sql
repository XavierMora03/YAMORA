-- Crear tipos ENUM
CREATE TYPE "genre" AS ENUM (
  'men',
  'female',
  'prefer_not_to_say'
);

CREATE TYPE "role_enum" AS ENUM (
  'usuario',
  'admin',
  'auditor'
);

-- Crear tabla users con 'telefono' como varchar y 'password' correctamente nombrado
CREATE TABLE "users" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "username" VARCHAR NOT NULL,
  "role" role_enum NOT NULL, -- Renombrado a 'role_enum'
  "mail" VARCHAR NOT NULL UNIQUE,
  "password" VARCHAR NOT NULL,
  "direccion" VARCHAR,
  "telefono" VARCHAR(15),
  "genero" genre,
  "birthday" DATE,
  "created_at" TIMESTAMP DEFAULT NOW()
);

-- Crear tabla homes
CREATE TABLE "homes" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "title" VARCHAR NOT NULL,
  "direction" VARCHAR NOT NULL,
  "colonia" VARCHAR NOT NULL,
  "municipio" VARCHAR NOT NULL,
  "n_rooms" INTEGER,
  "n_restrooms" INTEGER,
  "n_floors" INTEGER,
  "m2" INTEGER,
  "m2_constructed" INTEGER,
  "zipcode" VARCHAR(10),
  "rental_price" MONEY,
  "description" TEXT,
  "user_id" INTEGER REFERENCES "users" ("id") ON DELETE CASCADE,
  "status" BOOLEAN,
  "created_at" TIMESTAMP DEFAULT NOW(),
  "n_contacto" VARCHAR(15) -- Cambiado a VARCHAR(15)
);

-- Crear tabla homes_sell
CREATE TABLE "homes_sell" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "title" VARCHAR NOT NULL,
  "direction" VARCHAR NOT NULL,
  "colonia" VARCHAR NOT NULL,
  "municipio" VARCHAR NOT NULL,
  "n_rooms" INTEGER,
  "n_restrooms" INTEGER,
  "n_floors" INTEGER,
  "m2" INTEGER,
  "m2_constructed" INTEGER,
  "zipcode" VARCHAR(10),
  "price" MONEY,
  "description" TEXT,
  "user_id" INTEGER REFERENCES "users" ("id") ON DELETE CASCADE,
  "status" BOOLEAN,
  "created_at" TIMESTAMP DEFAULT NOW(),
  "n_contacto" VARCHAR(15) -- Cambiado a VARCHAR(15)
);

-- Crear tabla images
CREATE TABLE "images" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "home_id" INTEGER REFERENCES "homes" ("id") ON DELETE CASCADE,
  "image_url" VARCHAR NOT NULL,
  "created_at" TIMESTAMP DEFAULT NOW()
);

-- Crear tabla images_sell
CREATE TABLE "images_sell" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "home_id" INTEGER REFERENCES "homes_sell" ("id") ON DELETE CASCADE,
  "image_url" VARCHAR NOT NULL,
  "created_at" TIMESTAMP DEFAULT NOW()
);

-- Crear tabla rentals
CREATE TABLE "rentals" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "renter_id" INTEGER REFERENCES "users" ("id") ON DELETE CASCADE,
  "home_id" INTEGER REFERENCES "homes" ("id") ON DELETE CASCADE,
  "rental_start" DATE,
  "rental_end" DATE,
  "rental_price" MONEY,
  "rating" INTEGER CHECK (rating >= 1 AND rating <= 5) DEFAULT 3,
  "created_at" TIMESTAMP DEFAULT NOW()
);

-- Crear tabla user_ratings
CREATE TABLE "user_ratings" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  "user_id" INTEGER REFERENCES "users" ("id") ON DELETE CASCADE,
  "rated_by_user_id" INTEGER REFERENCES "users" ("id") ON DELETE CASCADE,
  "rating" INTEGER CHECK (rating >= 1 AND rating <= 5) DEFAULT 3,
  "rental_id" INTEGER REFERENCES "rentals" ("id") ON DELETE CASCADE,
  "created_at" TIMESTAMP DEFAULT NOW()
);

-- Crear tabla follows
CREATE TABLE "follows" (
  "following_user_id" INTEGER REFERENCES "users" ("id") ON DELETE CASCADE,
  "followed_user_id" INTEGER REFERENCES "users" ("id") ON DELETE CASCADE,
  "created_at" TIMESTAMP DEFAULT NOW(),
  PRIMARY KEY ("following_user_id", "followed_user_id")
);

-- Agregar comentarios
COMMENT ON COLUMN "homes"."description" IS 'Content of the post';
COMMENT ON COLUMN "homes_sell"."description" IS 'Content of the post';
COMMENT ON COLUMN "rentals"."rating" IS 'Valoración del alquiler entre 1-5';
COMMENT ON COLUMN "user_ratings"."rating" IS 'Valoración entre 1-5';


INSERT INTO "users" (username, role, mail, password, direccion, telefono, genero, birthday, created_at) VALUES
('juan_perez', 'usuario', 'juan.perez@example.com', 'hashed_password1', 'Calle Falsa 123', '5512345678', 'men', '1990-05-15', NOW()),
('maria_gomez', 'admin', 'maria.gomez@example.com', 'hashed_password2', 'Avenida Siempre Viva 742', '5523456789', 'female', '1985-08-22', NOW()),
('carlos_lopez', 'auditor', 'carlos.lopez@example.com', 'hashed_password3', 'Boulevard de los Sueños 456', '5534567890', 'men', '1978-12-03', NOW()),
('ana_martinez', 'usuario', 'ana.martinez@example.com', 'hashed_password4', 'Plaza de la Constitución 789', '5545678901', 'female', '1992-07-19', NOW()),
('luis_sanchez', 'usuario', 'luis.sanchez@example.com', 'hashed_password5', 'Camino Real 321', '5556789012', 'men', '1988-03-30', NOW()),
('laura_ramirez', 'admin', 'laura.ramirez@example.com', 'hashed_password6', 'Ruta Nacional 654', '5567890123', 'female', '1995-11-11', NOW()),
('diego_fernandez', 'usuario', 'diego.fernandez@example.com', 'hashed_password7', 'Sendero del Sol 987', '5578901234', 'men', '1983-02-25', NOW()),
('sara_castillo', 'auditor', 'sara.castillo@example.com', 'hashed_password8', 'Avenida Central 159', '5589012345', 'female', '1991-09-09', NOW()),
('jorge_garcia', 'usuario', 'jorge.garcia@example.com', 'hashed_password9', 'Camino del Río 753', '5590123456', 'men', '1987-04-14', NOW()),
('valeria_rodriguez', 'usuario', 'valeria.rodriguez@example.com', 'hashed_password10', 'Calle de la Luna 852', '5501234567', 'prefer_not_to_say', '1993-06-27', NOW());


INSERT INTO "homes" (title, direction, colonia, municipio, n_rooms, n_restrooms, n_floors, m2, m2_constructed, zipcode, rental_price, description, user_id, status, created_at, n_contacto) VALUES
('Departamento Moderno', 'Calle Falsa 123', 'Colonia Centro', 'Ciudad de México', 3, 2, 5, 80, 75, '01000', 15000, 'Departamento moderno en el corazón de la ciudad.', 1, TRUE, NOW(), '5512345678'),
('Casa Familiar', 'Avenida Siempre Viva 742', 'Colonia Sur', 'Guadalajara', 4, 3, 2, 120, 110, '44100', 25000, 'Amplia casa familiar con jardín.', 2, TRUE, NOW(), '5523456789'),
('Apartamento Compacto', 'Boulevard de los Sueños 456', 'Colonia Norte', 'Monterrey', 2, 1, 3, 60, 55, '64000', 12000, 'Apartamento compacto ideal para jóvenes profesionales.', 3, TRUE, NOW(), '5534567890'),
('Loft Urbano', 'Plaza de la Constitución 789', 'Colonia Centro', 'Ciudad de México', 1, 1, 4, 50, 45, '01000', 18000, 'Loft con diseño industrial en zona trendy.', 4, TRUE, NOW(), '5545678901'),
('Casa de Campo', 'Camino Real 321', 'Colonia Jardines', 'Puebla', 5, 4, 1, 200, 190, '72000', 30000, 'Espaciosa casa de campo con piscina y jardín.', 5, TRUE, NOW(), '5556789012'),
('Penthouse de Lujo', 'Ruta Nacional 654', 'Colonia Alta', 'Cancún', 4, 3, 10, 150, 145, '77500', 50000, 'Penthouse con vistas al mar y amenidades de lujo.', 6, TRUE, NOW(), '5567890123'),
('Estudio Económico', 'Sendero del Sol 987', 'Colonia Estrella', 'León', 1, 1, 2, 40, 35, '37000', 10000, 'Estudio económico ideal para estudiantes.', 7, TRUE, NOW(), '5578901234'),
('Casa Moderna', 'Avenida Central 159', 'Colonia Moderna', 'Tijuana', 3, 2, 2, 90, 85, '22000', 22000, 'Casa moderna con acabados de alta calidad.', 8, TRUE, NOW(), '5589012345'),
('Departamento en Torre', 'Camino del Río 753', 'Colonia Industrial', 'Querétaro', 2, 2, 15, 70, 65, '76000', 16000, 'Departamento en torre con excelentes servicios.', 9, TRUE, NOW(), '5590123456'),
('Casa Tradicional', 'Calle de la Luna 852', 'Colonia Tradicional', 'Morelia', 4, 3, 2, 130, 125, '58000', 24000, 'Casa tradicional con amplio jardín y terraza.', 10, TRUE, NOW(), '5501234567');

INSERT INTO "homes_sell" (title, direction, colonia, municipio, n_rooms, n_restrooms, n_floors, m2, m2_constructed, zipcode, price, description, user_id, status, created_at, n_contacto) VALUES
('Villa Exclusiva', 'Calle Primavera 111', 'Colonia Residencial', 'Ciudad de México', 5, 4, 3, 250, 240, '01050', 7500000, 'Villa exclusiva con piscina y seguridad 24/7.', 1, TRUE, NOW(), '5512345678'),
('Casa Colonial', 'Avenida de la Cultura 222', 'Colonia Histórica', 'Querétaro', 4, 3, 2, 180, 170, '76010', 4500000, 'Casa colonial con arquitectura tradicional.', 2, TRUE, NOW(), '5523456789'),
('Apartamento en Centro', 'Boulevard Central 333', 'Colonia Centro', 'Monterrey', 3, 2, 5, 100, 95, '64010', 3000000, 'Apartamento céntrico con excelentes vistas.', 3, TRUE, NOW(), '5534567890'),
('Casa Minimalista', 'Plaza del Arte 444', 'Colonia Moderna', 'Guadalajara', 3, 2, 2, 140, 135, '44110', 5000000, 'Casa minimalista con diseño abierto y luminoso.', 4, TRUE, NOW(), '5545678901'),
('Penthouse Exclusivo', 'Camino de la Playa 555', 'Colonia Alta', 'Cancún', 4, 3, 12, 160, 155, '77510', 8500000, 'Penthouse exclusivo frente al mar.', 5, TRUE, NOW(), '5556789012'),
('Casa de Ensueño', 'Ruta del Vino 666', 'Colonia Viñedos', 'Puebla', 6, 5, 2, 300, 290, '72010', 9500000, 'Casa de ensueño con viñedos propios.', 6, TRUE, NOW(), '5567890123'),
('Apartamento de Lujo', 'Sendero de la Luna 777', 'Colonia Premium', 'Tijuana', 3, 2, 8, 110, 105, '22010', 4000000, 'Apartamento de lujo con amenities exclusivos.', 7, TRUE, NOW(), '5578901234'),
('Casa de Playa', 'Avenida Marítima 888', 'Colonia Costera', 'Cancún', 4, 3, 1, 200, 190, '77520', 7000000, 'Casa de playa con acceso directo al mar.', 8, TRUE, NOW(), '5589012345'),
('Finca Rural', 'Camino del Campo 999', 'Colonia Rural', 'León', 5, 4, 1, 350, 340, '37010', 6000000, 'Finca rural con tierras y granjas.', 9, TRUE, NOW(), '5590123456'),
('Casa de Lujo', 'Calle Diamante 1010', 'Colonia Prestigiosa', 'Morelia', 5, 4, 3, 220, 210, '58010', 8000000, 'Casa de lujo con acabados de alta gama.', 10, TRUE, NOW(), '5501234567');

INSERT INTO "images" (home_id, image_url, created_at) VALUES
(1, 'https://example.com/images/homes/1/img1.jpg', NOW()),
(1, 'https://example.com/images/homes/1/img2.jpg', NOW()),
(2, 'https://example.com/images/homes/2/img1.jpg', NOW()),
(2, 'https://example.com/images/homes/2/img2.jpg', NOW()),
(3, 'https://example.com/images/homes/3/img1.jpg', NOW()),
(3, 'https://example.com/images/homes/3/img2.jpg', NOW()),
(4, 'https://example.com/images/homes/4/img1.jpg', NOW()),
(4, 'https://example.com/images/homes/4/img2.jpg', NOW()),
(5, 'https://example.com/images/homes/5/img1.jpg', NOW()),
(5, 'https://example.com/images/homes/5/img2.jpg', NOW()),
(6, 'https://example.com/images/homes/6/img1.jpg', NOW()),
(6, 'https://example.com/images/homes/6/img2.jpg', NOW()),
(7, 'https://example.com/images/homes/7/img1.jpg', NOW()),
(7, 'https://example.com/images/homes/7/img2.jpg', NOW()),
(8, 'https://example.com/images/homes/8/img1.jpg', NOW()),
(8, 'https://example.com/images/homes/8/img2.jpg', NOW()),
(9, 'https://example.com/images/homes/9/img1.jpg', NOW()),
(9, 'https://example.com/images/homes/9/img2.jpg', NOW()),
(10, 'https://example.com/images/homes/10/img1.jpg', NOW()),
(10, 'https://example.com/images/homes/10/img2.jpg', NOW());

INSERT INTO "images_sell" (home_id, image_url, created_at) VALUES
(1, 'https://example.com/images/homes_sell/1/img1.jpg', NOW()),
(1, 'https://example.com/images/homes_sell/1/img2.jpg', NOW()),
(2, 'https://example.com/images/homes_sell/2/img1.jpg', NOW()),
(2, 'https://example.com/images/homes_sell/2/img2.jpg', NOW()),
(3, 'https://example.com/images/homes_sell/3/img1.jpg', NOW()),
(3, 'https://example.com/images/homes_sell/3/img2.jpg', NOW()),
(4, 'https://example.com/images/homes_sell/4/img1.jpg', NOW()),
(4, 'https://example.com/images/homes_sell/4/img2.jpg', NOW()),
(5, 'https://example.com/images/homes_sell/5/img1.jpg', NOW()),
(5, 'https://example.com/images/homes_sell/5/img2.jpg', NOW()),
(6, 'https://example.com/images/homes_sell/6/img1.jpg', NOW()),
(6, 'https://example.com/images/homes_sell/6/img2.jpg', NOW()),
(7, 'https://example.com/images/homes_sell/7/img1.jpg', NOW()),
(7, 'https://example.com/images/homes_sell/7/img2.jpg', NOW()),
(8, 'https://example.com/images/homes_sell/8/img1.jpg', NOW()),
(8, 'https://example.com/images/homes_sell/8/img2.jpg', NOW()),
(9, 'https://example.com/images/homes_sell/9/img1.jpg', NOW()),
(9, 'https://example.com/images/homes_sell/9/img2.jpg', NOW()),
(10, 'https://example.com/images/homes_sell/10/img1.jpg', NOW()),
(10, 'https://example.com/images/homes_sell/10/img2.jpg', NOW());

INSERT INTO "rentals" (renter_id, home_id, rental_start, rental_end, rental_price, rating, created_at) VALUES
(1, 2, '2024-01-01', '2024-06-30', 25000, 5, NOW()),
(2, 3, '2024-02-15', '2024-08-15', 12000, 4, NOW()),
(3, 1, '2024-03-10', '2024-09-10', 15000, 5, NOW()),
(4, 4, '2024-04-20', '2024-10-20', 18000, 3, NOW()),
(5, 5, '2024-05-05', '2024-11-05', 30000, 4, NOW()),
(6, 6, '2024-06-18', '2024-12-18', 50000, 5, NOW()),
(7, 7, '2024-07-22', '2025-01-22', 10000, 4, NOW()),
(8, 8, '2024-08-30', '2025-02-28', 22000, 5, NOW()),
(9, 9, '2024-09-15', '2025-03-15', 16000, 3, NOW()),
(10, 10, '2024-10-01', '2025-04-01', 24000, 4, NOW());

INSERT INTO "user_ratings" (user_id, rated_by_user_id, rating, rental_id, created_at) VALUES
(2, 1, 5, 1, NOW()),
(3, 2, 4, 2, NOW()),
(1, 3, 5, 3, NOW()),
(4, 4, 3, 4, NOW()),
(5, 5, 4, 5, NOW()),
(6, 6, 5, 6, NOW()),
(7, 7, 4, 7, NOW()),
(8, 8, 5, 8, NOW()),
(9, 9, 3, 9, NOW()),
(10, 10, 4, 10, NOW());

INSERT INTO "follows" (following_user_id, followed_user_id, created_at) VALUES
(1, 2, NOW()),
(1, 3, NOW()),
(2, 3, NOW()),
(2, 4, NOW()),
(3, 5, NOW()),
(4, 1, NOW()),
(5, 2, NOW()),
(6, 7, NOW()),
(7, 8, NOW()),
(8, 9, NOW()),
(9, 10, NOW()),
(10, 1, NOW()),
(3, 6, NOW()),
(4, 7, NOW()),
(5, 8, NOW()),
(6, 9, NOW()),
(7, 10, NOW()),
(8, 1, NOW()),
(9, 2, NOW()),
(10, 3, NOW()),
(1, 4, NOW());
